<link rel="import" href="../../components/core-ajax/core-ajax.html" />
<polymer-element name="x-source-github" attributes="url">
  <template>

    <core-ajax id="ajax" url="{{ source }}" handleAs="text" on-core-response="{{ handleResponse }}"></core-ajax>

  </template>
  <script>
    Polymer('x-source-github', {

      ready: function () {
        if (!this.source) {
          this.urlChanged();
        }
      },

      urlChanged: function () {
        this.source = this.url.replace('github.com/', 'rawgit.com/').replace('/blob/', '/');
        if (!this.source) {
          return;
        }
        this.$.ajax.go();
      },

      handleResponse: function (event) {
        var response = event.detail.response;
        this.slides.markdown = response;
      }

    });
  </script>
</polymer-element>
